# NLP text processing
**Видео с реализацией сервиса:**

![Реализация suggestion сервиса:](https://github.com/Doranastasia/nlp_text_processing/blob/main/suggestion%20video.gif)

Основной **целью** проекта является создание системы для автодополнения текста и предсказания следующих слов на основе N-граммной модели. 

**Реализация:** Python + фреймворк Reflex.

**Отчет по второй части:**

Основой моей системы является N-граммная модель. Мы подсчитываем все N-граммы в корпусе текстов, фиксируя частоту появления определённых слов после каждой N-граммы. Для ускорения работы использовала префиксное дерево. После этого вычислялись вероятности: делили количество раз, когда N-грамма продолжалась конкретным словом, на общее число вхождений N-граммы. Далее проводилась сортировка продолжения по вероятности, а после на каждой итерации "жадно" предсказывалось следующее слово, выбирая самое вероятное продолжение. Когда предсказание было завершено, дописывался текст, находя наиболее частотное слово с таким же началом в словаре. Для обучения использовала датасет, состоящий из 500000 электронных писем, который был предварительно обработан.

Система во второй части была обернута в пользовательский интерфейс с использованием фреймворка **Reflex**. В результате чего был создан сайт, на котором пользователь может ввести последовательность слов в строку, нажать кнопку и получить наиболее вероятное продолжение текста.

---
## Система автодополнения текста и предсказания слов

### 1. **Префиксное дерево (`PrefixTree`)**

- **Цель**: Создание структуры для эффективного поиска слов по префиксу.
- **Методы**:
  - `add_word`: Добавляет слово в дерево.
  - `search_prefix`: Находит все слова, начинающиеся с заданного префикса, и возвращает их.
- Используется для быстрого поиска возможных продолжений слов.

### 2. **`WordCompletor`**

- **Цель**: Обеспечить автодополнение последнего введенного слова.
- **Алгоритм**:
  - Считывает частоту слов из корпуса.
  - Создает префиксное дерево для быстрого поиска продолжений слов.
  - Метод `get_words_and_probs`: возвращает список слов, начинающихся с префикса, и их вероятности, вычисляемые на основе частоты слов в корпусе.

### 3. **`NGramLanguageModel`**

- **Цель**: Построение модели для предсказания следующего слова на основе контекста (N-грамм).
- **Алгоритм**:
  - Для каждого текста в корпусе генерируются n-граммы.
  - Метод `get_next_words_and_probs`: находит возможные продолжения слов, используя n-граммы, и вычисляет их вероятности, основанные на частоте контекста.

### 4. **`TextSuggestion`**

- **Цель**: Генерация продолжений текста, используя методы автодополнения и N-граммной модели.
- **Алгоритм**:
  - Преобразует текст в список слов.
  - Дополняет последнее слово с помощью `WordCompletor`.
  - Генерирует продолжение текста с использованием N-граммной модели, выбирая наиболее вероятные слова для каждого шага.

---

## 5. Интеграция с Reflex

**Цель:** Разработать интуитивно понятный интерфейс для взаимодействия пользователя с системой автодополнения текста и предсказания слов.

#### Реализация:
- **Переменные**:
    - `prompt`: текст, введенный пользователем, который используется для генерации предложений.
    - `suggested_text`: сгенерированный системой текст, который является продолжением введенного запроса.
    - `processing`: флаг, который указывает на то, что процесс генерации текста еще не завершен.
    - `complete`: флаг, который сигнализирует о завершении процесса и готовности предложения.

- **Методы**:
    - `set_prompt`: обновляет состояние переменной `prompt` с текстом, введенным пользователем.
    - `get_suggestion`: генерирует продолжение текста на основе введенного запроса, используя модель автодополнения. Если текст не был введен, выводится предупреждение. Процесс асинхронный, и интерфейс обновляется, когда результат готов.

#### Интерфейс:
- Поле ввода текста, где пользователь может ввести запрос или продолжение фразы.
- Кнопка для активации процесса автодополнения текста. При нажатии кнопки происходит вызов метода `get_suggestion`, который генерирует продолжение текста.
- Область для отображения сгенерированного текста, которая обновляется в зависимости от результата работы модели автодополнения.
- Используются стили для улучшения визуального восприятия интерфейса: градиентный фон, адаптивные элементы, иконки для загрузки при обработке данных.

Таким образом, интерфейс предоставляет пользователю простой и эффективный способ взаимодействия с системой, обеспечивая мгновенную генерацию текстов.

---

### 6. **Результаты**

- **Достижения**:
  - Хорошее автодополнение введенного текста.
  - Довольно эффективное предсказание слов в контексте.
  - Возможность генерировать предложения в реальном времени.
    
---
